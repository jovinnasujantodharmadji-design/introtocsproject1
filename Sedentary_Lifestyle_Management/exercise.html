<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exercise Tracker</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="overlay" onclick="closeNav()"></div>
    <div id="toast"></div>

    <div id="mySidenav" class="sidenav">
        <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
        <a href="index.html">ğŸ“Š Dashboard</a>
        <a href="profile.html">ğŸ‘¤ User Profile</a>
        <a href="diet.html">ğŸ Diet Tracker</a>
        <a href="walking.html">ğŸ‘£ Walking</a>
        <a href="water.html">ğŸ’§ Water Tracker</a>
        <a href="sedentary.html">ğŸª‘ Sedentary Timer</a>
        <a href="stairs.html">ğŸªœ Stairs Tracker</a>
        <a href="sleep.html">ğŸ˜´ Sleep Manager</a>
        <a href="exercise.html" style="color: #6ab3f8;">ğŸƒ Exercise</a>
    </div>

    <div class="header-bar">
        <span class="menu-icon" onclick="openNav()">&#9776;</span>
    </div>

    <div class="container" style="margin-top: 0;">
        <h2>ğŸƒ Exercise Tracker</h2>
        
        <div class="card">
            <h3>Log Workout</h3>
            
            <label>Type:</label>
            <select id="ex-type">
                <option value="Running">ğŸƒ Running</option>
                <option value="Cycling">ğŸš´ Cycling</option>
                <option value="Gym">ğŸ‹ï¸ Gym / Weights</option>
                <option value="Yoga">ğŸ§˜ Yoga</option>
                <option value="Swimming">ğŸŠ Swimming</option>
                <option value="Other">âš¡ Other</option>
            </select>

            <div style="display:flex; gap:10px; margin-top:10px;">
                <div style="flex:1;">
                    <label>Duration (min):</label>
                    <input type="number" id="ex-duration" placeholder="30">
                </div>
                <div style="flex:1;">
                    <label>Calories (Est):</label>
                    <input type="number" id="ex-cal" placeholder="150">
                </div>
            </div>

            <button class="primary-btn" onclick="addExercise()" style="width:100%; margin-top:10px;">Log Activity</button>
        </div>

        <div class="card">
            <h3>Recent Activity</h3>
            <div id="ex-list" style="max-height:200px; overflow-y:auto;"></div>
            <button class="danger-btn small" onclick="clearExercise()" style="width:100%; margin-top:10px;">Clear Log</button>
        </div>
    </div>

    <script>
        function openNav() { document.getElementById("mySidenav").style.width = "250px"; document.getElementById("overlay").style.display = "block"; }
        function closeNav() { document.getElementById("mySidenav").style.width = "0"; document.getElementById("overlay").style.display = "none"; }
        function showToast(msg) { const t=document.getElementById('toast'); t.textContent=msg; t.className="show"; setTimeout(()=>t.className=t.className.replace("show",""),3000); }

        let exercises = JSON.parse(localStorage.getItem('exercises') || '[]');

        function renderList() {
            const list = document.getElementById('ex-list');
            list.innerHTML = '';
            if(exercises.length === 0) list.innerHTML = '<p style="text-align:center;color:#999;">No activities yet.</p>';

            exercises.forEach(e => {
                const div = document.createElement('div');
                div.className = 'food-list-item';
                div.innerHTML = `
                    <div>
                        <strong>${e.type}</strong> <small style="color:#888">${e.date}</small><br>
                        <span class="nutrition-detail">${e.dur} min | ${e.cal} kcal</span>
                    </div>
                `;
                list.appendChild(div);
            });
        }

        function addExercise() {
            const type = document.getElementById('ex-type').value;
            const dur = document.getElementById('ex-duration').value;
            const cal = document.getElementById('ex-cal').value;

            if(!dur || !cal) return showToast("Fill in duration & calories");

            exercises.unshift({ 
                id: Date.now(), 
                type: type, 
                dur: dur, 
                cal: cal, 
                date: new Date().toLocaleDateString() 
            });
            
            localStorage.setItem('exercises', JSON.stringify(exercises));
            document.getElementById('ex-duration').value = '';
            document.getElementById('ex-cal').value = '';
            renderList();
            showToast("Workout Logged!");
        }

        function clearExercise() {
            if(confirm("Clear log?")) {
                exercises = [];
                localStorage.removeItem('exercises');
                renderList();
            }
        }

        // Auto-calculate rough calories based on duration & weight (Simplified METs)
        document.getElementById('ex-duration').addEventListener('input', function() {
            const mins = this.value;
            const type = document.getElementById('ex-type').value;
            const weight = localStorage.getItem('profileWeight') || 70;
            let mets = 4; // default
            
            if(type === 'Running') mets = 8;
            if(type === 'Cycling') mets = 6;
            if(type === 'Swimming') mets = 7;
            if(type === 'Gym') mets = 5;
            if(type === 'Yoga') mets = 3;

            // Kcal = METs * Weight(kg) * Time(hr)
            if(mins > 0) {
                const estCal = Math.round(mets * weight * (mins/60));
                document.getElementById('ex-cal').value = estCal;
            }
        });

        document.addEventListener('DOMContentLoaded', renderList);
    </script>
</body>
</html>
